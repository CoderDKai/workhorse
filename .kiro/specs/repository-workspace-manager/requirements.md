# 需求文档

## 介绍

这是一个基于 Git worktree 概念的仓库管理软件，旨在帮助开发者更方便地在不同分支之间进行切换和管理。软件采用工作区(workspace)的概念，允许用户为每个仓库创建多个工作区，每个工作区对应一个独立的分支环境。

## 需求

### 需求 1 - 仓库管理

**用户故事：** 作为开发者，我希望能够添加和管理多个软件仓库，以便在一个统一的界面中管理所有项目。

#### 验收标准

1. 当用户添加新仓库时，系统应该允许用户指定仓库路径和名称
2. 当用户添加仓库后，系统应该验证该路径是否为有效的 Git 仓库
3. 当仓库验证成功后，系统应该在仓库根目录下创建 `.workhorse` 目录作为工作区存放位置
4. 当创建 `.workhorse` 目录后，系统应该配置 Git 全局忽略该目录，防止其被提交
5. 当用户设置源分支时，系统应该允许用户从现有分支中选择或输入分支名称
6. 当用户配置初始化脚本时，系统应该允许用户输入和保存脚本内容
7. 当仓库配置完成后，系统应该将仓库信息持久化存储

### 需求 2 - 工作区创建和管理

**用户故事：** 作为开发者，我希望能够为每个仓库创建多个工作区，以便同时在不同分支上进行开发工作。

#### 验收标准

1. 当用户创建工作区时，系统应该要求用户输入工作区名称
2. 当用户确认创建工作区时，系统应该在 `.workhorse` 目录下从源分支创建新的 Git worktree
3. 当工作区创建成功后，系统应该自动运行配置的初始化脚本
4. 当初始化脚本执行完成后，系统应该记录工作区的创建时间和路径信息
5. 当工作区创建失败时，系统应该显示错误信息并清理部分创建的资源

### 需求 3 - 工作区归档功能

**用户故事：** 作为开发者，我希望能够归档完成的工作区，以便节省硬盘空间并保持项目整洁。

#### 验收标准

1. 当用户选择归档工作区时，系统应该提示用户确认操作
2. 当用户确认归档后，系统应该删除工作区的文件系统内容
3. 当工作区被归档后，系统应该保留工作区的元数据信息
4. 当用户需要时，系统应该允许重新激活已归档的工作区
5. 当重新激活工作区时，系统应该重新创建 worktree 并运行初始化脚本

### 需求 4 - 三栏布局界面展示

**用户故事：** 作为开发者，我希望通过直观的三栏布局界面查看和管理所有仓库和工作区，以便快速了解项目状态和进行开发操作。

#### 验收标准

1. 当系统加载时，应该显示左中右三栏布局的主界面
2. 当显示左侧菜单栏时，应该以菜单形式展示所有已添加的仓库和工作区
3. 当显示仓库菜单项时，应该显示仓库名称作为菜单标题
4. 当点击仓库菜单项时，应该打开仓库设置界面而不是展开/收起
5. 当打开仓库设置界面时，应该占据中部和右侧的全部空间
6. 当显示仓库设置界面时，应该隐藏中部和右侧的工作区相关内容
7. 当关闭仓库设置界面时，应该恢复中部和右侧空间的之前状态
5. 当显示工作区菜单项时，应该显示当前分支名称和 Git 更改统计 (+xx -xx)
6. 当显示工作区次级信息时，应该包含工作区文件夹名称和创建时间
7. 当显示右侧面板时，应该分为上下两个区域
8. 当显示右侧上方区域时，应该展示详细的 Git 状态信息
9. 当显示右侧下方区域时，应该提供终端功能
10. 当显示中间区域时，应该保留为空白区域供未来扩展
11. 当用户调整界面时，所有区块应该支持大小缩放功能
12. 当选择工作区时，中部和右侧空间应该显示该工作区的相关信息
13. 当未选择工作区时，中部和右侧空间应该显示默认提示信息

### 需求 5 - Git 状态监控

**用户故事：** 作为开发者，我希望能够实时查看每个工作区的 Git 状态，以便了解当前的开发进度。

#### 验收标准

1. 当工作区处于活动状态时，系统应该定期检查 Git 状态
2. 当检测到文件更改时，系统应该计算并显示添加和删除的行数
3. 当分支发生切换时，系统应该更新显示的分支名称
4. 当 Git 状态检查失败时，系统应该显示适当的错误指示
5. 当工作区被归档时，系统应该停止 Git 状态监控

### 需求 6 - Git 状态详细显示

**用户故事：** 作为开发者，我希望能够查看详细的 Git 文件状态信息，以便了解当前工作区的具体更改情况。

#### 验收标准

1. 当选择工作区时，右侧上方应该显示该工作区的详细 Git 状态
2. 当显示文件状态时，应该包含状态图标（新增文件、修改文件、删除文件）
3. 当显示文件信息时，应该包含文件名和完整路径
4. 当显示代码更改时，应该分别显示新增行数和删除行数 (+xx -xx)
5. 当没有选择工作区时，Git 状态区域应该显示提示信息

### 需求 7 - 集成终端功能

**用户故事：** 作为开发者，我希望能够在应用内使用终端，以便执行命令和查看脚本执行过程。

#### 验收标准

1. 当显示右侧下方区域时，应该提供终端界面
2. 当用户需要时，应该支持创建新的终端实例
3. 当执行初始化脚本时，应该在终端中实时显示命令执行过程
4. 当命令执行完成时，应该在终端中显示执行结果和退出状态
5. 当用户切换工作区时，终端应该自动切换到对应的工作目录

### 需求 8 - 界面状态管理

**用户故事：** 作为开发者，我希望应用程序能够智能地管理不同界面状态，以便在仓库设置和工作区操作之间无缝切换。

#### 验收标准

1. 当用户点击仓库菜单项时，系统应该保存当前中右部空间的状态
2. 当显示仓库设置界面时，系统应该隐藏工作区相关的中右部内容
3. 当仓库设置界面占据中右部空间时，应该保持左侧菜单栏可见
4. 当用户关闭仓库设置界面时，系统应该恢复之前保存的中右部状态
5. 当用户在仓库设置界面时切换到其他仓库，应该直接显示新仓库的设置
6. 当用户从仓库设置界面点击工作区时，应该关闭设置界面并显示工作区内容
7. 当没有选择任何工作区时，中右部空间应该显示 Workhorse 品牌页面

### 需求 9 - 默认欢迎页面

**用户故事：** 作为开发者，我希望在没有选择工作区时看到一个美观的欢迎页面，以便快速开始使用应用程序。

#### 验收标准

1. 当没有选择工作区时，中右部空间应该显示 Workhorse 品牌页面
2. 当显示品牌页面时，应该展示 Workhorse 的 CSS 动画化纯文字 logo
3. 当显示操作选项时，应该在 logo 下方提供三个操作块
4. 当显示"Open Project"选项时，应该配备文件夹图标
5. 当显示"Clone from GitHub"选项时，应该配备 GitHub 图标
6. 当显示"Clone from URL"选项时，应该配备网络图标
7. 当用户点击操作选项时，应该触发相应的功能
8. 当操作选项显示时，应该以独立的块状布局呈现，而不是下拉选择框

### 需求 10 - 数据持久化

**用户故事：** 作为开发者，我希望系统能够保存我的仓库和工作区配置，以便下次启动时恢复之前的状态。

#### 验收标准

1. 当用户添加仓库时，系统应该将仓库配置保存到本地存储
2. 当用户创建工作区时，系统应该将工作区信息保存到本地存储
3. 当系统启动时，应该从本地存储加载所有仓库和工作区信息
4. 当配置发生更改时，系统应该自动保存更新
5. 当数据损坏时，系统应该提供数据恢复或重置选项